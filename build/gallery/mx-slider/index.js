import e from"../../lib/magix.js";import t from"../mx-dragdrop/index.js";e.applyStyle("xla",'[mx-view*="/mx-slider/index"]{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.xl-K{height:4px;border-radius:2px}.xl-L,.xl-K{background:#fff;cursor:pointer}.xl-L{width:8px;height:8px;border-radius:50%;position:absolute;top:-2px;margin-left:-4px;box-shadow:0 0 0 2px hsla(0,0%,100%,.4)}.xl-M{background:#88cbfb;position:absolute;top:0}.xl-N,.xl-M{height:4px;border-radius:2px}.xl-N{background:#999}');export default e.View.extend({tmpl:(e,t,i,s)=>{let l,d,o=[],{id:r,buffer:n,bufferValue:a,value:h}=e;return l=[],n&&(d=[t("div",{class:"xl-N",style:"width:"+s(100*a)+"%"})],l.push(...d)),l.push(t("div",{class:"xl-M",style:"width:"+s(100*h)+"%"})),o.push(t("div",{class:"xl-K",id:"t_"+s(r),"mx-click":i+"\x1e_j()"},l),t("div",{class:"xl-L",style:"left:"+s(100*h)+"%","mx-mousedown":i+"\x1e_k()"})),t(i,0,o)},mixins:[t],assign(e){return!this._i&&(this.set(e),!0)},render(){this.digest()},"_j<click>"(t){let i=t.eventTarget.getBoundingClientRect(),s=(t.pageX-i.left)/i.width;this.digest({value:s}),e.dispatch(this.root,"change",{percent:s})},"_k<mousedown>"(t){let i=e.node("t_"+this.id).getBoundingClientRect(),s=this.get("value")||0;this._i=1,this._d(t,l=>{let d=(l.pageX-t.pageX)/i.width+s;d>1?d=1:d<0&&(d=0),this.digest({value:d}),e.dispatch(this.root,"update",{percent:d})},()=>{e.dispatch(this.root,"change",{percent:this.get("value")}),delete this._i})}});