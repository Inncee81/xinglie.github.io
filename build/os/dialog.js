let t;import i from"../lib/magix.js";import e from"../gallery/mx-dragdrop/index.js";import s from"./ctrl.js";import l from"./exchange.js";export default i.View.extend({tmpl:(i,e,s,l,h,d,p)=>{let a,o,_,x,n,m=[],{show:g,active:c,maxState:r,left:u,top:w,width:y,height:f,zIndex:v,id:I,appId:k,icon:H,title:S,min:V,max:b,close:X,view:j,scroll:z,resize:C}=i;return _=[],n=[e(0,1,l(H))],a="xl-h",c&&(a+=" xl-i"),x=[e("div",{class:a},n),e(0,0,l(S))],_.push(e("div",{class:"xl-g","mx-mousedown":s+"\x1e_W()",id:l(k)+"_d_t"},x)),x=[],V&&(n=[e("span",{_:"_",class:"xl-l xl-n","mx-click":s+"\x1e_R()"})],x.push(...n)),b&&(a="xl-l xl-o",r&&(a+=" xl-q"),n=[e("span",{"mx-click":s+"\x1e_S()",class:a})],x.push(...n)),X&&(n=[e("span",{_:"a",class:"xl-l xl-m","mx-click":s+"\x1e_T()"})],x.push(...n)),a="xl-j",c&&(a+=" xl-p"),_.push(e("div",{class:a},x)),t?x=[t]:(n=[e(0,0,"loading...")],x=[t=e("div",{_:"b",class:"xl-v"},n)]),a="xl-t",z&&(a+=" xl-u"),_.push(e("div",{$:"maxState","mx-view":l(j)+"?maxState="+p(d,r,"\x1e_"),class:a},x)),o="",c&&(o+="display:none"),_.push(e("div",{class:"xl-w",style:o}),e("div",{class:"xl-w xl-x",id:l(I)+"_mk"})),C&&!r&&(a="xl-r",c&&(a+=" xl-s"),x=[e("div",{"mx-mousedown":s+"\x1e_X()",class:a})],_.push(...x)),a="xl-f xl-y",g&&(a+=" xl-z"),c&&(a+=" xl-k"),o="",r||(o+="left:"+l(u)+"px;top:"+l(w)+"px;width:"+l(y)+"px;height:"+l(f)+"px;"),o+="z-index:"+l(v),m.push(e("div",{id:l(I)+"_d","mx-mousedown":s+"\x1e_U()",class:a,style:o},_)),e(s,0,m)},mixins:[e],init(t){let i=t.maxState?4:8;i|=2,this._H=i,l.fire("_I",{icon:t.icon,title:t.title,appId:t.appId});let e=this.root;this.on("destroy",()=>{s._w(this.get("appId")),e.parentNode.removeChild(e),l.fire("_J",{id:this.get("appId")})})},assign(t){return this.set(t),!0},render(){this.digest()},_K(){let t=this._H;2&t&&(this._H=2^t|1,this.root.style.display="",this.digest({show:!0}))},_C(){let t=this._H;1&t&&(this._H=1^t|2,s._x(this.get("appId")),l.fire("_L",{id:this.get("appId")}),this.digest({show:!1}),this.root.style.display="none")},_v(){this.get("show")?this.digest({active:!0}):(this.set({active:!0}),this._K()),l.fire("_M",{id:this.get("appId")})},_E(){this.digest({active:!1}),l.fire("_N",{id:this.get("appId")})},_O(){let t=i.node(this.id+"_mk");t&&(t.style.display="block")},_P(){let t=i.node(this.id+"_mk");t&&(t.style.display="none")},_Q(){let t=this._H;i.node("d_"+this.id);4&t?(this._H=4^t|8,this.digest({maxState:!1})):(this._H=8^t|4,this.digest({maxState:!0}))},"_R<click>"(){this._C()},"_S<click>"(){this._Q()},"_T<click>"(t){this.owner.unmountVframe()},"_U<mousedown>"(){s._v(this.get("appId"))},"_W<mousedown>"(t){let e=this._H,s=getComputedStyle(document.body),l=parseInt(s.getPropertyValue("--xl-_")),h=document.body.clientWidth,d=document.body.clientHeight-l,p=i.node(this.id+"_d").style,{left:a,top:o,width:_}=this.get(),x=!1;this._O(),this._d(t,i=>{if(x=!0,4==(4&e))return;let s=i.pageX-t.pageX+a;s<50-_?s=50-_:s>h-50&&(s=h-50);let n=i.pageY-t.pageY+o;n<0?n=0:n>d-50+l&&(n=d-50+l),p.left=s+"px",p.top=n+"px",this.set({left:s,top:n})},t=>{if(this._P(),!x&&this.get("max")){let t=Date.now();if(this._V){t-this._V<300?(this._V="",this._Q()):this._V=t}else this._V=t}})},"_X<mousedown>"(t){let e=i.node(this.id+"_d").style,{width:s,height:l,minWidth:h,minHeight:d}=this.get();this._O(),this._d(t,i=>{let p=i.pageX-t.pageX+s;p<h&&(p=h);let a=i.pageY-t.pageY+l;a<d&&(a=d),e.width=p+"px",e.height=a+"px",this.set({width:p,height:a})},()=>{this._P()})}});