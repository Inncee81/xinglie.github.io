/*!1.0.2 kooboy_li@163.com*/
let t;import i from"../lib/magix.js";import e from"../gallery/mx-dragdrop/index.js";import s from"./ctrl.js";import l from"./exchange.js";export default i.View.extend({tmpl:(i,e,s,l,h,d,a)=>{let p,o,_,x,n,m=[],{show:g,active:c,maxState:r,left:u,top:w,width:y,height:f,zIndex:v,id:I,appId:k,icon:S,title:K,min:Y,max:b,close:X,view:j,scroll:z,resize:V}=i;return _=[],n=[e(0,1,l(S))],p="xl-h",c&&(p+=" xl-i"),x=[e("div",{class:p},n),e(0,0,l(K))],_.push(e("div",{class:"xl-g","mx-mousedown":s+"\x1e_Z()",id:l(k)+"_d_t"},x)),x=[],Y&&(n=[e("span",{_:"_",class:"xl-l xl-n","mx-click":s+"\x1e_U()"})],x.push(...n)),b&&(p="xl-l xl-o",r&&(p+=" xl-q"),n=[e("span",{"mx-click":s+"\x1e_V()",class:p})],x.push(...n)),X&&(n=[e("span",{_:"a",class:"xl-l xl-m","mx-click":s+"\x1e_W()"})],x.push(...n)),p="xl-j",c&&(p+=" xl-p"),_.push(e("div",{class:p},x)),t?x=[t]:(n=[e(0,0,"loading...")],x=[t=e("div",{_:"b",class:"xl-v"},n)]),p="xl-t",z&&(p+=" xl-u"),_.push(e("div",{$:"maxState","mx-view":l(j)+"?maxState="+a(d,r,"\x1e_"),class:p},x)),o="",c&&(o+="display:none"),_.push(e("div",{class:"xl-w",style:o}),e("div",{class:"xl-w xl-x",id:l(I)+"_mk"})),V&&!r&&(p="xl-r",c&&(p+=" xl-s"),x=[e("div",{"mx-mousedown":s+"\x1e_a_()",class:p})],_.push(...x)),p="xl-f xl-y",g&&(p+=" xl-z"),c&&(p+=" xl-k"),o="",r||(o+="left:"+l(u)+"px;top:"+l(w)+"px;width:"+l(y)+"px;height:"+l(f)+"px;"),o+="z-index:"+l(v),m.push(e("div",{id:l(I)+"_d","mx-mousedown":s+"\x1e_X()",class:p,style:o},_)),e(s,0,m)},mixins:[e],init(t){let i=t.maxState?4:8;i|=2,this._K=i,l.fire("_L",{icon:t.icon,title:t.title,appId:t.appId});let e=this.root;this.on("destroy",()=>{s._z(this.get("appId")),e.parentNode.removeChild(e),l.fire("_M",{id:this.get("appId")})})},assign(t){return this.set(t),!0},render(){this.digest()},_N(){let t=this._K;2&t&&(this._K=2^t|1,this.root.style.display="",this.digest({show:!0}))},_F(){let t=this._K;1&t&&(this._K=1^t|2,s._A(this.get("appId")),l.fire("_O",{id:this.get("appId")}),this.digest({show:!1}),this.root.style.display="none")},_y(){this.get("show")?this.digest({active:!0}):(this.set({active:!0}),this._N()),l.fire("_P",{id:this.get("appId")})},_H(){this.digest({active:!1}),l.fire("_Q",{id:this.get("appId")})},_R(){let t=i.node(this.id+"_mk");t&&(t.style.display="block")},_S(){let t=i.node(this.id+"_mk");t&&(t.style.display="none")},_T(){let t=this._K;i.node("d_"+this.id);4&t?(this._K=4^t|8,this.digest({maxState:!1})):(this._K=8^t|4,this.digest({maxState:!0}))},"_U<click>"(){this._F()},"_V<click>"(){this._T()},"_W<click>"(t){this.owner.unmountVframe()},"_X<mousedown>"(){s._y(this.get("appId"))},"_Z<mousedown>"(t){let e=this._K,s=getComputedStyle(document.body),l=parseInt(s.getPropertyValue("--xl-_")),h=document.body.clientWidth,d=document.body.clientHeight-l,a=i.node(this.id+"_d").style,{left:p,top:o,width:_}=this.get(),x=!1;this._R(),this._d(t,i=>{if(x=!0,4==(4&e))return;let s=i.pageX-t.pageX+p;s<50-_?s=50-_:s>h-50&&(s=h-50);let n=i.pageY-t.pageY+o;n<0?n=0:n>d-50+l&&(n=d-50+l),a.left=s+"px",a.top=n+"px",this.set({left:s,top:n})},t=>{if(this._S(),!x&&this.get("max")){let t=Date.now();if(this._Y){t-this._Y<300?(this._Y="",this._T()):this._Y=t}else this._Y=t}})},"_a_<mousedown>"(t){let e=i.node(this.id+"_d").style,{width:s,height:l,minWidth:h,minHeight:d}=this.get();this._R(),this._d(t,i=>{let a=i.pageX-t.pageX+s;a<h&&(a=h);let p=i.pageY-t.pageY+l;p<d&&(p=d),e.width=a+"px",e.height=p+"px",this.set({width:a,height:p})},()=>{this._S()})}});