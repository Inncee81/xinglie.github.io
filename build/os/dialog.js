let t;import i from"../lib/magix.js";import e from"../gallery/mx-dragdrop/index.js";import s from"./ctrl.js";import l from"./exchange.js";export default i.View.extend({tmpl:(i,e,s,l,h,d,a)=>{let p,o,_,x,n,m=[],{show:g,active:c,maxState:r,left:u,top:w,width:y,height:f,zIndex:v,appId:I,icon:k,title:S,min:L,max:z,close:X,view:Y,scroll:b,data:j,resize:Z}=i;return _=[],n=[e(0,l(k),1)],p="xl-i",c&&(p+=" xl-j"),x=[e("div",{class:p},n),e(0,l(S))],_.push(e("div",{class:"xl-h","mx5-mousedown":s+"\x1e\x1e_0()",id:l(I)+"_d_t"},x)),x=[],L&&(n=[e("span",{class:"xl-m xl-o","mx5-click":s+"\x1e\x1e_V()"})],x.push(...n)),z&&(p="xl-m xl-p",r&&(p+=" xl-r"),n=[e("span",{"mx5-click":s+"\x1e\x1e_W()",class:p})],x.push(...n)),X&&(n=[e("span",{class:"xl-m xl-n","mx5-click":s+"\x1e\x1e_X()"})],x.push(...n)),p="xl-k",c&&(p+=" xl-q"),_.push(e("div",{class:p},x)),t?x=[t]:(n=[e(0,"loading...")],x=[t=e("div",{_:"_",class:"xl-w"},n)]),p="xl-u",b&&(p+=" xl-v"),_.push(e("div",{"mx5-owner":s,$:"maxState,data","mx5-view":l(Y)+"?maxState="+a(d,r,"\x1e_")+"&data="+a(d,j,"\x1ea"),class:p},x)),o="",c&&(o+="display:none"),_.push(e("div",{class:"xl-x",style:o}),e("div",{class:"xl-x xl-y",id:s+"_mk"})),Z&&!r&&(p="xl-s",c&&(p+=" xl-t"),x=[e("div",{"mx5-mousedown":s+"\x1e\x1e_1()",class:p})],_.push(...x)),p="xl-g xl-z",g&&(p+=" xl-A"),c&&(p+=" xl-l"),o="",r||(o+="left:"+l(u)+"px;top:"+l(w)+"px;width:"+l(y)+"px;height:"+l(f)+"px;"),o+="z-index:"+l(v),m.push(e("div",{id:s+"_d","mx5-mousedown":s+"\x1e_Y()",class:p,style:o},_)),e(s,0,m)},init(t){let i=t.maxState?4:8;i|=2,this._L=i,l.fire("_M",{icon:t.icon,title:t.title,appId:t.appId});let e=this.root;this.on("destroy",()=>{s._A(this.get("appId")),e.parentNode.removeChild(e),l.fire("_N",{id:this.get("appId")})})},assign(t){return this.set(t),!0},render(){this.digest()},_O(){let t=this._L;2&t&&(this._L=2^t|1,this.root.style.display="",this.digest({show:!0}))},_G(){let t=this._L;1&t&&(this._L=1^t|2,s._B(this.get("appId")),l.fire("_P",{id:this.get("appId")}),this.digest({show:!1}),this.root.style.display="none")},_z(){this.get("show")?this.digest({active:!0}):(this.set({active:!0}),this._O()),l.fire("_Q",{id:this.get("appId")})},_I(){this.digest({active:!1}),l.fire("_R",{id:this.get("appId")})},_S(){let t=i.node(this.id+"_mk");t&&(t.style.display="block")},_T(){let t=i.node(this.id+"_mk");t&&(t.style.display="none")},_U(){let t=this._L;4&t?(this._L=4^t|8,this.digest({maxState:!1})):(this._L=8^t|4,this.digest({maxState:!0}))},"_V<click>"(){this._G()},"_W<click>"(){this._U()},"_X<click>"(t){this.owner.unmount()},"_Y<mousedown>"(){s._z(this.get("appId"))},"_0<mousedown>"(t){let e=this._L,s=getComputedStyle(document.body),l=parseInt(s.getPropertyValue("--xl-_")),h=document.body.clientWidth,d=document.body.clientHeight-l,a=i.node(this.id+"_d").style,{left:p,top:o,width:_}=this.get(),x=!1;this._S(),this._d(t,i=>{if(x=!0,4==(4&e))return;let s=i.pageX-t.pageX+p;s<50-_?s=50-_:s>h-50&&(s=h-50);let n=i.pageY-t.pageY+o;n<0?n=0:n>d-50+l&&(n=d-50+l),a.left=s+"px",a.top=n+"px",this.set({left:s,top:n})},t=>{if(this._T(),!x&&this.get("max")){let t=Date.now();if(this._Z){t-this._Z<300?(this._Z="",this._U()):this._Z=t}else this._Z=t}})},"_1<mousedown>"(t){let e=i.node(this.id+"_d").style,{width:s,height:l,minWidth:h,minHeight:d}=this.get();this._S(),this._d(t,i=>{let a=i.pageX-t.pageX+s;a<h&&(a=h);let p=i.pageY-t.pageY+l;p<d&&(p=d),e.width=a+"px",e.height=p+"px",this.set({width:a,height:p})},()=>{this._T()})}}).merge(e);