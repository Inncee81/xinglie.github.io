/*!1.0.2 kooboy_li@163.com*/
let t={class:"xl-O xl-R"};import r from"../../lib/magix.js";import e from"../../os/wallpaper.js";import l from"../../lib/agent.js";import a from"../../lib/cron.js";r.applyStyle("xld",".xl-O{width:310px;border-radius:2px;background:rgba(0,0,0,.53);height:62px;padding:2px 0;overflow:auto;box-shadow:0 -1px 0 6px rgba(0,0,0,.53)}.xl-P{width:100px;height:60px;background-size:cover;background-repeat:no-repeat;float:left;cursor:pointer;background-color:hsla(0,0%,100%,.2)}.xl-Q{margin-right:5px}.xl-R{scrollbar-width:thin;-ms-overflow-style:none}.xl-R::-webkit-scrollbar{height:0;width:0}.xl-R:hover::-webkit-scrollbar{height:2px}.xl-R::-webkit-scrollbar-corner{height:0;width:0}.xl-R::-webkit-scrollbar-thumb{background:hsla(0,0%,100%,.47);border-radius:2px}.xl-R::-webkit-scrollbar-thumb:hover{background:#fff}");let o="http://wallpaper.apc.360.cn/index.php?c=WallPaper&a=getAppsByCategory&cid=9&count=40&from=360chrome&start=";export default r.View.extend({tmpl:(r,e,l,a,o,i,s,h)=>{let p,d,c,n,b,g=[],{list:x}=r;if(x&&x.length){c=[];for(let t=x.length,r=t-1,o=0;o<t;o++){let t=x[o],i=o===r,s=t.url.replace("bdr/__85","bdr/200_120_60");b="xl-P",i||(b+=" xl-Q"),n=[e("div",{style:"background-image:url("+a(s)+")","mx-click":l+"\x1e_aq({thumb:'"+h(s)+"',src:'"+h(t.url)+"'})",class:b})],c.push(...n)}d=[e("div",{style:"height:100%;width:"+a(105*x.length-5)+"px"},c)],p=[e("div",t,d)],g.push(...p)}return e(l,0,g)},async render(){try{let{start:t,last:r,exist:e}=(()=>{let t=Math.floor(400*Math.random()),r=localStorage.getItem("ls#bg.random"),e=0,l=0;if(r){let a=JSON.parse(r);a._am>Date.now()?(t=a._an,l=1):e=a._an}return{exist:l,start:t,last:e}})();l.clear(o+r,36e5),e||localStorage.setItem("ls#bg.random",JSON.stringify({_am:18e5+Date.now(),_an:t}));let a=await l.request(o+t,36e5,!0),i=JSON.parse(a),s=[];i&&i.data&&(s=i.data),this.digest({list:s}),this._ao(s)}catch(t){this.digest()}},_ao(t){if(!this._ap){this._ap=1;let r=()=>{let r=Math.floor(Math.random()*t.length),l=t[r].url,a=l.replace("bdr/__85","bdr/200_120_60");e._al(a,l)};a._r(r,216e5,!0),this.on("destroy",()=>{a._s(r)})}},"_aq<click>"(t){let{thumb:r,src:l}=t.params;e._al(r,l)}});