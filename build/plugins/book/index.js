let $quick_h_4_static_node,$quick_h_0_static_attr={class:"xl-U"},$quick_h_1_static_attr={class:"xl-R"},$quick_h_2_static_attr={class:"xl-V"},$quick_h_3_static_attr={class:"xl-W"},$quick_h_5_static_attr={class:"xl-Z"};import Magix from"../../lib/magix.js";import Data from"./db.js";Magix.applyStyle("xld",".xl-Q{-webkit-box-flex:0.3;flex:0.3;padding:3px 4px;height:30px;font-size:16px;box-sizing:border-box;box-shadow:none;border:1px solid #ccc;background-color:#fff;vertical-align:middle;width:100%;outline:none}.xl-R{-webkit-box-flex:0.6;flex:0.6}.xl-S{float:left;padding:0 8px;cursor:pointer}.xl-T{background:#fafafa;color:#000}.xl-U{background:#f96447;height:40px;line-height:40px;color:#fff;padding:0 10px;font-size:16px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.xl-V{background:#fafafa;color:#333;height:28px;line-height:28px;position:-webkit-sticky;position:sticky;top:0;font-weight:700}.xl-V,.xl-W{padding:0 26px}.xl-X{padding:5px 0}.xl-Y{border-bottom:1px solid #f3f3f3}.xl-Z{position:-webkit-sticky;position:sticky;bottom:0;height:30px;background:#fafafa;line-height:30px}.xl-a_,.xl-Z{padding:0 26px}.xl-a_{font-size:16px;height:50px;line-height:50px}.xl-aa{text-decoration:none;margin-right:10px}.xl-aa:hover{text-decoration:underline}");let Sort=(t,e)=>t.py.localeCompare(e.py),Tabs=[{name:"\u4e66\u540d",key:"py"},{name:"\u4f5c\u8005",key:"apy"},{name:"\u51fa\u7248",key:"ppy"}],Displays={py:["title","category","author","translater","publisher"],apy:["author","category","title","translater","publisher"],cpy:["category","title","author","translater","publisher"],ppy:["publisher","category","title","author","translater"]},Searches={py:["py","title"],apy:["apy","author"],cpy:["cpy","category"],ppy:["ppy","publisher"]},IdMap={title:"\u4e66\u540d",category:"\u5927\u7c7b",author:"\u4f5c\u8005",translater:"\u7ffb\u8bd1",publisher:"\u51fa\u7248"},uncode=t=>t.title.replace(/-/g," ")+" "+t.author;export default Magix.View.extend({tmpl:(t,e,a,r,l,i,s,o)=>{let p,c,h,n,x,_,u,d,f,g,k=[],{tabs:b,active:y,search:m,list:w,displays:q,keyMap:v,uncode:$,total:S}=t;c=[];for(let t=0,l=b,i=l.length;t<i;t++){let i=l[t];x=[e(0,0,r(i.name))],n="xl-S",i.key==y&&(n+=" xl-T"),h=[e("li",{"mx-click":i.key!=y&&a+"\x1e_X({tab:'"+o(i.key)+"'})",class:n},x)],c.push(...h)}p=[e("ul",$quick_h_1_static_attr,c),e("input",{class:"xl-Q",placeholder:"\u641c\u7d22","mx-input":a+"\x1e_a_()",value:r(m)},0,1)],k.push(e("div",$quick_h_0_static_attr,p));let M=0;if(w.length){p=[];for(let t=0,a=w,i=a.length;t<i;t++){let i=a[t];x=[e(0,0,r(i.letter))],h=[e("div",$quick_h_2_static_attr,x)],x=[];for(let t=0,a=i.books,s=a.length,o=s-1;t<s;t++){let i=a[t],s=t===o;u=[],M++;for(let t=0,a=q,l=a.length;t<l;t++){let l=a[t];d=[],i[l]&&(g=[e(0,0,r(v[l])+"\uff1a"+r(i[l]))],f=[e("div",0,g)],d.push(...f)),u.push(...d)}d=[e(0,0,"\u641c\u7d22\uff1a")],f=[e(0,0,"\u767e\u5ea6")],d.push(e("a",{class:"xl-aa",href:"//www.baidu.com/s?wd="+l($(i)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u6dd8\u5b9d")],d.push(e("a",{class:"xl-aa",href:"//s.taobao.com/search?q="+l($(i)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u5929\u732b")],d.push(e("a",{class:"xl-aa",href:"//list.tmall.com/search_product.htm?q="+l($(i)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u4eac\u4e1c")],d.push(e("a",{class:"xl-aa",href:"//search.jd.com/Search?keyword="+l($(i))+"&enc=utf-8&wq="+l($(i)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u5f53\u5f53")],d.push(e("a",{class:"xl-aa",href:"http://search.dangdang.com/?key="+l($(i)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u8c46\u74e3")],d.push(e("a",{class:"xl-aa",href:"//www.douban.com/search?cat=1001&q="+l($(i)),target:"_blank",rel:"noopener noreferrer"},f)),u.push(e("div",0,d)),n="xl-X",s||(n+=" xl-Y"),_=[e("li",{class:n},u)],x.push(..._)}h.push(e("ul",$quick_h_3_static_attr,x)),c=[e("div",0,h)],p.push(...c)}k.push(...p)}else $quick_h_4_static_node?p=[$quick_h_4_static_node]:(c=[e(0,0,"\u6682\u65e0\u76f8\u5173\u4e66\u7c4d")],p=[$quick_h_4_static_node=e("div",{_:"_",class:"xl-a_"},c)]),k.push(...p);return p=[e(0,0,"\u5171"+r(S)+"\u672c\uff0c\u5f53\u524d\u5217\u8868\u6709")],c=[e(0,0,r(M))],p.push(e("span",0,c),e(0,0,"\u672c")),k.push(e("div",$quick_h_5_static_attr,p)),e(a,0,k)},ctor(){this.set({uncode:uncode,active:"py"})},render(){let t=[],e={},a=this.get("active"),r=this.get("search");for(let t of Data)if(t[a]){let l=t[a][0].toLowerCase();if(r){let i=!1,s=Searches[a];for(let e of s)t[e].indexOf(r)>-1&&(i=!0,BarProp);i&&(e[l]||(e[l]=[]),e[l].push(t))}else e[l]||(e[l]=[]),e[l].push(t)}for(let a,r,l=48;l<123;l++)(r=e[a=String.fromCharCode(l)])&&(r=r.sort(Sort),t.push({letter:a.toUpperCase(),books:r}));this.digest({total:Data.length,tabs:Tabs,list:t,displays:Displays[a],keyMap:IdMap})},"_X<click>"(t){this.set({active:t.params.tab}),this.render()},"_a_<input>"(t){this.set({search:t.eventTarget.value}),clearTimeout(this._Y);let e=Magix.mark(this,"_Z");this._Y=setTimeout(()=>{e()&&this.render()},500)}});