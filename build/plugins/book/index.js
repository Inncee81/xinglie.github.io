/*!1.0.2 kooboy_li@163.com*/
let e,a={class:"xl-ad"},t={class:"xl-aa"},l={class:"xl-ae"},r={class:"xl-af"},s={class:"xl-ai"},o={value:"value"};import i from"../../lib/magix.js";import p from"./db.js";i.applyStyle("xlg",".xl-a_{flex:0.3;padding:3px 4px;height:30px;font-size:16px;box-sizing:border-box;box-shadow:none;border:1px solid #ccc;background-color:#fff;vertical-align:middle;width:100%;outline:none}.xl-aa{flex:0.6}.xl-ab{float:left;padding:0 8px;cursor:pointer}.xl-ac{background:#fafafa;color:#000}.xl-ad{background:#f96447;height:40px;line-height:40px;color:#fff;padding:0 10px;font-size:16px;display:flex;align-items:center}.xl-ae{background:#fafafa;color:#333;height:28px;line-height:28px;position:-webkit-sticky;position:sticky;top:0;font-weight:700}.xl-ae,.xl-af{padding:0 26px}.xl-ag{padding:5px 0}.xl-ah{border-bottom:1px solid #f3f3f3}.xl-ai{position:-webkit-sticky;position:sticky;bottom:0;height:30px;background:#fafafa;line-height:30px}.xl-aj,.xl-ai{padding:0 26px}.xl-aj{font-size:16px;height:50px;line-height:50px}.xl-ak{text-decoration:none;margin-right:10px}.xl-ak:hover{text-decoration:underline}");let n=(e,a)=>e.py.localeCompare(a.py),h=[{name:"\u4e66\u540d",key:"py"},{name:"\u4f5c\u8005",key:"apy"},{name:"\u51fa\u7248",key:"ppy"}],c={py:["title","category","author","translater","publisher"],apy:["author","category","title","translater","publisher"],cpy:["category","title","author","translater","publisher"],ppy:["publisher","category","title","author","translater"]},x={py:["py","title"],apy:["apy","author"],cpy:["cpy","category"],ppy:["ppy","publisher"]},u={title:"\u4e66\u540d",category:"\u5927\u7c7b",author:"\u4f5c\u8005",translater:"\u7ffb\u8bd1",publisher:"\u51fa\u7248"},d=e=>e.title.replace(/-/g," ")+" "+e.author;export default i.View.extend({tmpl:(i,p,n,h,c,x,u,d)=>{let f,g,y,b,k,m,v,_,w,j,C=[],{tabs:q,active:z,search:S,list:T,displays:M,keyMap:B,uncode:L,total:O}=i;g=[];for(let e=q.length,a=0;a<e;a++){let e=q[a];k=[p(0,0,h(e.name))],b="xl-ab",e.key==z&&(b+=" xl-ac"),y=[p("li",{"mx-click":e.key!=z&&n+"\x1e_ar({tab:'"+d(e.key)+"'})",class:b},k)],g.push(...y)}f=[p("ul",t,g),p("input",{class:"xl-a_",placeholder:"\u641c\u7d22","mx-input":n+"\x1e_au()",value:h(S)},0,o,1)],C.push(p("div",a,f));let P=0;if(T.length){f=[];for(let e=T.length,a=0;a<e;a++){let e=T[a];k=[p(0,0,h(e.letter))],y=[p("div",l,k)],k=[];for(let a=e.books,t=a.length,l=t-1,r=0;r<t;r++){let e=a[r],t=r===l;v=[],P++;for(let a=M.length,t=0;t<a;t++){let a=M[t];_=[],e[a]&&(j=[p(0,0,h(B[a])+"\uff1a"+h(e[a]))],w=[p("div",0,j)],_.push(...w)),v.push(..._)}_=[p(0,0,"\u641c\u7d22\uff1a")],w=[p(0,0,"\u767e\u5ea6")],_.push(p("a",{class:"xl-ak",href:"//www.baidu.com/s?wd="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},w)),w=[p(0,0,"\u6dd8\u5b9d")],_.push(p("a",{class:"xl-ak",href:"//s.taobao.com/search?q="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},w)),w=[p(0,0,"\u5929\u732b")],_.push(p("a",{class:"xl-ak",href:"//list.tmall.com/search_product.htm?q="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},w)),w=[p(0,0,"\u4eac\u4e1c")],_.push(p("a",{class:"xl-ak",href:"//search.jd.com/Search?keyword="+c(L(e))+"&enc=utf-8&wq="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},w)),w=[p(0,0,"\u5f53\u5f53")],_.push(p("a",{class:"xl-ak",href:"http://search.dangdang.com/?key="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},w)),w=[p(0,0,"\u8c46\u74e3")],_.push(p("a",{class:"xl-ak",href:"//www.douban.com/search?cat=1001&q="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},w)),v.push(p("div",0,_)),b="xl-ag",t||(b+=" xl-ah"),m=[p("li",{class:b},v)],k.push(...m)}y.push(p("ul",r,k)),g=[p("div",0,y)],f.push(...g)}C.push(...f)}else e?f=[e]:(g=[p(0,0,"\u6682\u65e0\u76f8\u5173\u4e66\u7c4d")],f=[e=p("div",{_:"_",class:"xl-aj"},g)]),C.push(...f);return f=[p(0,0,"\u5171"+h(O)+"\u672c\uff0c\u5f53\u524d\u5217\u8868\u6709")],g=[p(0,0,h(P))],f.push(p("span",0,g),p(0,0,"\u672c")),C.push(p("div",s,f)),p(n,0,C)},ctor(){this.set({uncode:d,active:"py"})},assign:()=>!1,render(){let e=[],a={},t=this.get("active"),l=this.get("search");for(let e of p)if(e[t]){let r=e[t][0].toLowerCase();if(l){let s=!1,o=x[t];for(let a of o)e[a].indexOf(l)>-1&&(s=!0,BarProp);s&&(a[r]||(a[r]=[]),a[r].push(e))}else a[r]||(a[r]=[]),a[r].push(e)}for(let t,l,r=48;r<123;r++)(l=a[t=String.fromCharCode(r)])&&(l=l.sort(n),e.push({letter:t.toUpperCase(),books:l}));this.digest({total:p.length,tabs:h,list:e,displays:c[t],keyMap:u})},"_ar<click>"(e){this.set({active:e.params.tab}),this.render()},"_au<input>"(e){this.set({search:e.eventTarget.value}),clearTimeout(this._as);let a=i.mark(this,"_at");this._as=setTimeout(()=>{a()&&this.render()},500)}});