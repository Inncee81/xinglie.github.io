let $quick_h_4_static_node,$quick_h_0_static_attr={class:"xl-ab"},$quick_h_1_static_attr={class:"xl-Z"},$quick_h_2_static_attr={class:"xl-ac"},$quick_h_3_static_attr={class:"xl-ad"},$quick_h_5_static_attr={class:"xl-ag"};import Magix from"../../lib/magix.js";import Data from"./db.js";Magix.applyStyle("xle",".xl-Y{-webkit-box-flex:0.3;flex:0.3;padding:3px 4px;height:30px;font-size:16px;box-sizing:border-box;box-shadow:none;border:1px solid #ccc;background-color:#fff;vertical-align:middle;width:100%;outline:none}.xl-Z{-webkit-box-flex:0.6;flex:0.6}.xl-a_{float:left;padding:0 8px;cursor:pointer}.xl-aa{background:#fafafa;color:#000}.xl-ab{background:#f96447;height:40px;line-height:40px;color:#fff;padding:0 10px;font-size:16px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.xl-ac{background:#fafafa;color:#333;height:28px;line-height:28px;position:-webkit-sticky;position:sticky;top:0;font-weight:700}.xl-ac,.xl-ad{padding:0 26px}.xl-ae{padding:5px 0}.xl-af{border-bottom:1px solid #f3f3f3}.xl-ag{position:-webkit-sticky;position:sticky;bottom:0;height:30px;background:#fafafa;line-height:30px}.xl-ah,.xl-ag{padding:0 26px}.xl-ah{font-size:16px;height:50px;line-height:50px}.xl-ai{text-decoration:none;margin-right:10px}.xl-ai:hover{text-decoration:underline}");let Sort=(t,e)=>t.py.localeCompare(e.py),Tabs=[{name:"\u4e66\u540d",key:"py"},{name:"\u4f5c\u8005",key:"apy"},{name:"\u51fa\u7248",key:"ppy"}],Displays={py:["title","category","author","translater","publisher"],apy:["author","category","title","translater","publisher"],cpy:["category","title","author","translater","publisher"],ppy:["publisher","category","title","author","translater"]},Searches={py:["py","title"],apy:["apy","author"],cpy:["cpy","category"],ppy:["ppy","publisher"]},IdMap={title:"\u4e66\u540d",category:"\u5927\u7c7b",author:"\u4f5c\u8005",translater:"\u7ffb\u8bd1",publisher:"\u51fa\u7248"},uncode=t=>t.title.replace(/-/g," ")+" "+t.author;export default Magix.View.extend({tmpl:(t,e,a,r,i,l,s,o)=>{let p,c,h,n,x,u,_,d,f,g,b=[],{tabs:k,active:y,search:m,list:w,displays:q,keyMap:v,uncode:$,total:M}=t;c=[];for(let t=0,i=k,l=i.length;t<l;t++){let l=i[t];x=[e(0,0,r(l.name))],n="xl-a_",l.key==y&&(n+=" xl-aa"),h=[e("li",{"mx-click":l.key!=y&&a+"\x1e_Y({tab:'"+o(l.key)+"'})",class:n},x)],c.push(...h)}p=[e("ul",$quick_h_1_static_attr,c),e("input",{class:"xl-Y",placeholder:"\u641c\u7d22","mx-input":a+"\x1e_aa()",value:r(m)},0,1)],b.push(e("div",$quick_h_0_static_attr,p));let S=0;if(w.length){p=[];for(let t=0,a=w,l=a.length;t<l;t++){let l=a[t];x=[e(0,0,r(l.letter))],h=[e("div",$quick_h_2_static_attr,x)],x=[];for(let t=0,a=l.books,s=a.length,o=s-1;t<s;t++){let l=a[t],s=t===o;_=[],S++;for(let t=0,a=q,i=a.length;t<i;t++){let i=a[t];d=[],l[i]&&(g=[e(0,0,r(v[i])+"\uff1a"+r(l[i]))],f=[e("div",0,g)],d.push(...f)),_.push(...d)}d=[e(0,0,"\u641c\u7d22\uff1a")],f=[e(0,0,"\u767e\u5ea6")],d.push(e("a",{class:"xl-ai",href:"//www.baidu.com/s?wd="+i($(l)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u6dd8\u5b9d")],d.push(e("a",{class:"xl-ai",href:"//s.taobao.com/search?q="+i($(l)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u5929\u732b")],d.push(e("a",{class:"xl-ai",href:"//list.tmall.com/search_product.htm?q="+i($(l)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u4eac\u4e1c")],d.push(e("a",{class:"xl-ai",href:"//search.jd.com/Search?keyword="+i($(l))+"&enc=utf-8&wq="+i($(l)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u5f53\u5f53")],d.push(e("a",{class:"xl-ai",href:"http://search.dangdang.com/?key="+i($(l)),target:"_blank",rel:"noopener noreferrer"},f)),f=[e(0,0,"\u8c46\u74e3")],d.push(e("a",{class:"xl-ai",href:"//www.douban.com/search?cat=1001&q="+i($(l)),target:"_blank",rel:"noopener noreferrer"},f)),_.push(e("div",0,d)),n="xl-ae",s||(n+=" xl-af"),u=[e("li",{class:n},_)],x.push(...u)}h.push(e("ul",$quick_h_3_static_attr,x)),c=[e("div",0,h)],p.push(...c)}b.push(...p)}else $quick_h_4_static_node?p=[$quick_h_4_static_node]:(c=[e(0,0,"\u6682\u65e0\u76f8\u5173\u4e66\u7c4d")],p=[$quick_h_4_static_node=e("div",{_:"_",class:"xl-ah"},c)]),b.push(...p);return p=[e(0,0,"\u5171"+r(M)+"\u672c\uff0c\u5f53\u524d\u5217\u8868\u6709")],c=[e(0,0,r(S))],p.push(e("span",0,c),e(0,0,"\u672c")),b.push(e("div",$quick_h_5_static_attr,p)),e(a,0,b)},ctor(){this.set({uncode:uncode,active:"py"})},render(){let t=[],e={},a=this.get("active"),r=this.get("search");for(let t of Data)if(t[a]){let i=t[a][0].toLowerCase();if(r){let l=!1,s=Searches[a];for(let e of s)t[e].indexOf(r)>-1&&(l=!0,BarProp);l&&(e[i]||(e[i]=[]),e[i].push(t))}else e[i]||(e[i]=[]),e[i].push(t)}for(let a,r,i=48;i<123;i++)(r=e[a=String.fromCharCode(i)])&&(r=r.sort(Sort),t.push({letter:a.toUpperCase(),books:r}));this.digest({total:Data.length,tabs:Tabs,list:t,displays:Displays[a],keyMap:IdMap})},"_Y<click>"(t){this.set({active:t.params.tab}),this.render()},"_aa<input>"(t){this.set({search:t.eventTarget.value}),clearTimeout(this._Z);let e=Magix.mark(this,"_a_");this._Z=setTimeout(()=>{e()&&this.render()},500)}});