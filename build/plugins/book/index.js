/*!1.0.5 kooboy_li@163.com*/
let e,a={class:"xl-ad"},t={class:"xl-aa"},l={class:"xl-ae"},r={class:"xl-af"},o={class:"xl-ai"},s={value:"value"};import i from"../../lib/magix.js";import p from"./db.js";i.applyStyle("xl-g",".xl-a_{-webkit-box-flex:0.3;flex:0.3;padding:3px 4px;height:30px;font-size:16px;box-sizing:border-box;box-shadow:none;border:1px solid #ccc;background-color:#fff;vertical-align:middle;width:100%;outline:none}.xl-aa{-webkit-box-flex:0.6;flex:0.6}.xl-ab{float:left;padding:0 8px;cursor:pointer}.xl-ac{background:#fafafa;color:#000}.xl-ad{background:#f96447;height:40px;line-height:40px;color:#fff;padding:0 10px;font-size:16px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.xl-ae{background:#fafafa;color:#333;height:28px;line-height:28px;position:-webkit-sticky;position:sticky;top:0;font-weight:700}.xl-ae,.xl-af{padding:0 26px}.xl-ag{padding:5px 0}.xl-ah{border-bottom:1px solid #f3f3f3}.xl-ai{position:-webkit-sticky;position:sticky;bottom:0;height:30px;background:#fafafa;line-height:30px}.xl-aj,.xl-ai{padding:0 26px}.xl-aj{font-size:16px;height:50px;line-height:50px}.xl-ak{text-decoration:none;margin-right:10px}.xl-ak:hover{text-decoration:underline}");let n=(e,a)=>e.py.localeCompare(a.py),h=[{name:"\u4e66\u540d",key:"py"},{name:"\u4f5c\u8005",key:"apy"},{name:"\u51fa\u7248",key:"ppy"}],c={py:["title","category","author","translater","publisher"],apy:["author","category","title","translater","publisher"],cpy:["category","title","author","translater","publisher"],ppy:["publisher","category","title","author","translater"]},x={py:["py","title"],apy:["apy","author"],cpy:["cpy","category"],ppy:["ppy","publisher"]},d={title:"\u4e66\u540d",category:"\u5927\u7c7b",author:"\u4f5c\u8005",translater:"\u7ffb\u8bd1",publisher:"\u51fa\u7248"},f=e=>e.title.replace(/-/g," ")+" "+e.author;export default i.View.extend({tmpl:(i,p,n,h,c,x,d,f)=>{let u,g,b,k,y,m,v,w,_,j,C=[],{tabs:q,active:z,search:S,list:T,displays:M,keyMap:B,uncode:L,total:O}=i;g=[];for(let e=q.length,a=0;a<e;a++){let e=q[a];y=[p(0,0,h(e.name))],k="xl-ab",e.key==z&&(k+=" xl-ac"),b=[p("li",{"mx-click":e.key!=z&&n+"\x1e_as({tab:'"+f(e.key)+"'})",class:k},y)],g.push(...b)}u=[p("ul",t,g),p("input",{class:"xl-a_",placeholder:"\u641c\u7d22","mx-input":n+"\x1e_av()",value:h(S)},0,s,1)],C.push(p("div",a,u));let P=0;if(T.length){u=[];for(let e=T.length,a=0;a<e;a++){let e=T[a];y=[p(0,0,h(e.letter))],b=[p("div",l,y)],y=[];for(let a=e.books,t=a.length,l=t-1,r=0;r<t;r++){let e=a[r],t=r===l;v=[],P++;for(let a=M.length,t=0;t<a;t++){let a=M[t];w=[],e[a]&&(j=[p(0,0,h(B[a])+"\uff1a"+h(e[a]))],_=[p("div",0,j)],w.push(..._)),v.push(...w)}w=[p(0,0,"\u641c\u7d22\uff1a")],_=[p(0,0,"\u767e\u5ea6")],w.push(p("a",{class:"xl-ak",href:"//www.baidu.com/s?wd="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},_)),_=[p(0,0,"\u6dd8\u5b9d")],w.push(p("a",{class:"xl-ak",href:"//s.taobao.com/search?q="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},_)),_=[p(0,0,"\u5929\u732b")],w.push(p("a",{class:"xl-ak",href:"//list.tmall.com/search_product.htm?q="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},_)),_=[p(0,0,"\u4eac\u4e1c")],w.push(p("a",{class:"xl-ak",href:"//search.jd.com/Search?keyword="+c(L(e))+"&enc=utf-8&wq="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},_)),_=[p(0,0,"\u5f53\u5f53")],w.push(p("a",{class:"xl-ak",href:"http://search.dangdang.com/?key="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},_)),_=[p(0,0,"\u8c46\u74e3")],w.push(p("a",{class:"xl-ak",href:"//www.douban.com/search?cat=1001&q="+c(L(e)),target:"_blank",rel:"noopener noreferrer"},_)),v.push(p("div",0,w)),k="xl-ag",t||(k+=" xl-ah"),m=[p("li",{class:k},v)],y.push(...m)}b.push(p("ul",r,y)),g=[p("div",0,b)],u.push(...g)}C.push(...u)}else e?u=[e]:(g=[p(0,0,"\u6682\u65e0\u76f8\u5173\u4e66\u7c4d")],u=[e=p("div",{_:"_",class:"xl-aj"},g)]),C.push(...u);return u=[p(0,0,"\u5171"+h(O)+"\u672c\uff0c\u5f53\u524d\u5217\u8868\u6709")],g=[p(0,0,h(P))],u.push(p("span",0,g),p(0,0,"\u672c")),C.push(p("div",o,u)),p(n,0,C)},ctor(){this.set({uncode:f,active:"py"})},assign:()=>!1,render(){let e=[],a={},t=this.get("active"),l=this.get("search");for(let e of p)if(e[t]){let r=e[t][0].toLowerCase();if(l){let o=!1,s=x[t];for(let a of s)e[a].indexOf(l)>-1&&(o=!0,BarProp);o&&(a[r]||(a[r]=[]),a[r].push(e))}else a[r]||(a[r]=[]),a[r].push(e)}for(let t,l,r=48;r<123;r++)(l=a[t=String.fromCharCode(r)])&&(l=l.sort(n),e.push({letter:t.toUpperCase(),books:l}));this.digest({total:p.length,tabs:h,list:e,displays:c[t],keyMap:d})},"_as<click>"(e){this.set({active:e.params.tab}),this.render()},"_av<input>"(e){this.set({search:e.eventTarget.value}),clearTimeout(this._at);let a=i.mark(this,"_au");this._at=setTimeout(()=>{a()&&this.render()},500)}});