/*!1.0.2 kooboy_li@163.com*/
let t,a={class:"xl-aH"},e={class:"xl-aI"},i={class:"xl-aJ"},s={class:"xl-aL"},l={class:"xl-aK"};import r from"../../lib/magix.js";import h from"../../lib/agent.js";r.applyStyle("xlk",".xl-aH{margin:10px}.xl-aI{margin-bottom:10px;border:1px solid #ccc;border-radius:5px}.xl-aJ{font-size:16px;font-weight:700;margin:5px 0 0 10px}.xl-aK{height:18px;margin-left:10px;font-size:12px}.xl-aL{padding:10px}.xl-aM{width:auto;height:auto}.xl-aN{font-size:20px;text-align:center;height:40px;line-height:40px}");let o=[{_aL(){this._aJ=1,this._aK="http://www.gaoxiaogif.com/"},_aM(){let t=this._aK,a=this._aJ++;return new Promise(async e=>{let i="";a>1&&(i=`index_${a}.html`);let s=[];try{let a=await h.request(t+i,0,!0),e=/'pic':'([^']+)','text':'([^']+)'[\s\S]+?<i\s+class="icon-clock"><\/i>([0-9\-]+)/g;a.replace(e,(t,a,e,i)=>(s.push({name:"",img:a,date:i,from:"\u641e\u7b11GIF\u56fe\u7247\u96c6"}),""))}catch(t){}e(s)})}},{_aL(){this._aJ=1,this._aK="https://interface.sina.cn/tech/gif/album.d.json?format=json&num=20&page="},_aM(){let t=this._aK,a=this._aJ++;return new Promise(async e=>{let i=[];try{let e=await h.request(t+a,0,!0),s=JSON.parse(e);if(s.data)for(let t of s.data)i.push({name:t.name,img:t.img_url,date:t.createtime,from:"\u65b0\u6d6a\u8da3\u56fe"})}catch(t){}e(i)})}},{_aL(){this._aJ=1,this._aK="http://quicklol.com/"},_aM(){let t=this._aK,a=this._aJ++;return new Promise(async e=>{let i="";a>1&&(i=`page/${a}/`);let s=[];try{let a=await h.request(t+i,0,!0),e=/<img[\s\S]+?class="[^"]+?wp-image-\d+"\s+src="([^"]+)"[\s\S]+?data-a2a-title="([^"]+)"/g;a.replace(e,(t,a,e)=>(s.push({name:e,img:a,from:"quicklol.com"}),""))}catch(t){}e(s)})}}];export default r.View.extend({tmpl:(r,h,o,n)=>{let c,p,m,g,x=[],{list:d}=r;c=[];for(let t=d.length,a=0;a<t;a++){let t=d[a];g=[h(0,0,n(t.name))],m=[h("div",i,g)],g=[h("img",{class:"xl-aM",src:n(t.img)},0,0,1)],m.push(h("div",s,g)),g=[h(0,0,n(t.from)+" "+n(t.date))],m.push(h("div",l,g)),p=[h("div",e,m)],c.push(...p)}return t?c.push(t):(p=[h(0,0,"\u66f4\u591a\u52a0\u8f7d\u4e2d...")],c.push(t=h("div",{_:"_",class:"xl-aN"},p))),x.push(h("div",a,c)),h(o,0,x)},init(){for(let t of o)t._aL();this.set({list:[]})},assign:()=>!1,async render(){let t=Math.floor(Math.random()*o.length),a=o[t],e=await a._aM(),i=this.get("list");i.push(...e),this.digest({list:i}),delete this._aN},"$win<scroll>&capture"(t){if(t.target==this.root&&!this._aN){let t=this.root;t.scrollTop+t.offsetHeight+500>t.scrollHeight&&(this._aN=1,this.render())}}});