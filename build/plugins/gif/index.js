/*!1.0.5 kooboy_li@163.com*/
import"../../gallery/mx-more/index.js";let t={class:"xl-aO"},a={class:"xl-aP"},e={class:"xl-aQ"},i={class:"xl-aS"},s={class:"xl-aU"},l={class:"xl-aR"};import h from"../../lib/magix.js";import r from"../../lib/agent.js";h.applyStyle("xl-l",'.xl-aO{margin:10px}.xl-aP{margin-bottom:10px;border:1px solid #ccc;border-radius:5px}.xl-aQ{font-size:16px;font-weight:700;margin:5px 0 0 10px}.xl-aR{height:18px;margin-left:10px;font-size:12px}.xl-aS{padding:10px;min-height:100px}.xl-aT{width:auto;height:auto;max-width:100%;min-height:50px;position:relative}.xl-aT:before{content:"\u56fe\u7247\u65e0\u6cd5\u663e\u793a\u2299\ufe4f\u2299";position:absolute;display:-webkit-inline-box;display:inline-flex;top:-4px;left:0;height:calc(100% + 8px);width:calc(100% + 200px);background-color:#ebebeb;border-radius:4px;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center;color:#a2a2a2}.xl-aU{font-size:18px}');let o=(t,a)=>{let e;do{e=Math.ceil(Math.random()*t)}while(1===a[e]);return a[e]=1,e},c=(t,a)=>t.w-a.w,n=[{_aO(){this._aL=500,this._aM={},this._aN="https://www.soogif.com/hotGif?start=${0}&size=20"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];t=t.replace("${0}",e);try{let a=await r.request(t,0,!0),e=JSON.parse(a);if(0==e.code){let t=e.data.result;for(let a of t)i.push({name:a.title,from:"soogif.com",img:a.gifurl})}}catch(t){}a(i)})}},{_aO(){this._aL=400,this._aM={},this._aN="http://www.gaoxiaogif.com/"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i="";e>1&&(i=`index_${e}.html`);let s=[];try{let a=await r.request(t+i,0,!0,"gb2312"),e=/'pic':'([^']+)','text':'([^']+)'[\s\S]+?<i\s+class="icon-clock"><\/i>([0-9\-]+)/g;a.replace(e,(t,a,e,i)=>(s.push({name:e,img:a,date:i,from:"\u641e\u7b11GIF\u56fe\u7247\u96c6"}),""))}catch(t){}a(s)})}},{_aO(){this._aL=50,this._aM={},this._aN="https://interface.sina.cn/tech/gif/album.d.json?format=json&num=20&page="},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];try{let a=await r.request(t+e,0,!0),s=JSON.parse(a);if(s.data)for(let t of s.data)i.push({name:t.name,img:t.img_url,date:t.createtime,from:"\u65b0\u6d6a\u8da3\u56fe"})}catch(t){}a(i)})}},{_aO(){this._aL=500,this._aM={},this._aN="http://quicklol.com/"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i="";e>1&&(i=`page/${e}/`);let s=[];try{let a=await r.request(t+i,0,!0),e=/<img[\s\S]+?class="[^"]+?wp-image-\d+"\s+src="([^"]+)"[\s\S]+?data-a2a-title="([^"]+)"/g;a.replace(e,(t,a,e)=>(s.push({name:e,img:a,from:"quicklol.com"}),""))}catch(t){}a(s)})}},{_aO(){this._aL=102,this._aM={},this._aN="http://xiaohua.zol.com.cn/qutu/${0}.html"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];try{t=t.replace("${0}",e);let a=await r.request(t,0,!0,"gbk"),s=/<span\s+class="article-title"><[^>]+>([\s\S]+?)<\/[^>]+><\/span>[\s\S]+?<div\s+class="summary-text">[\s\S]+?src="([^"]+)"/g;a.replace(s,(t,a,e)=>(e=e.replace(/\/t_s300x2000\//,"/t_s600x5000/"),i.push({name:a,img:e,date:"",from:"xiaohua.zol.com.cn"}),""))}catch(t){}a(i)})}},{_aO(){this._aL=847,this._aM={},this._aN="http://www.tucaojie.com/"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[],s="";e>1&&(s=`index_${e}.html`);try{let a=await r.request(t+s,0,!0),e=/<img[^>]+?src="[^>]*?\/(d\/file\/[^"]+)"[^>]+alt="([^"]+)"/g;a.replace(e,(a,e,s)=>(i.push({name:s,img:t+e,date:"",from:"\u5410\u69fd\u8857"}),""))}catch(t){}a(i)})}},{_aO(){this._aL=31099,this._aM={},this._aN="https://www.biedoul.com/index/${0}/"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];t=t.replace("${0}",e);try{let a=await r.request(t,0,!0),e=/<DD>[\S\s]+?<STRONG>([\s\S]*?)<\/STRONG>[\S\s]+?<DD>([\s\S]+?)<\/DD>/g,s=/<img([^>]+?)src="(\/[^>]+)"/gi;a.replace(e,(t,a,e)=>(e=e.replace(s,(t,a,e)=>`<img${a}src="https://www.biedoul.com${e}"`),i.push({name:a,text:e,date:"",from:"\u522b\u9017\u4e86"}),""))}catch(t){}a(i)})}},{_aO(){this._aL=50,this._aM={},this._aN="http://www.budejie.com/${0}"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];t=t.replace("${0}",e);try{let a=await r.request(t,0,!0),e=/<div class="j-r-list-c-desc">\s*<a[^>]+>([\S\s]+?)<\/a>[\s\S]+?<img[^>]+?data-original="([^"]+)"/g;a.replace(e,(t,a,e)=>(i.push({name:a,img:e,date:"",from:"\u767e\u601d\u4e0d\u5f97\u59d0"}),""))}catch(t){}a(i)})}},{_aO(){this._aL=195,this._aM={},this._aN="http://www.51xiaohua.com/ye${0}.html"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];t=t.replace("${0}",e);try{let a=await r.request(t,0,!0),e=/<a href="\/baoxiaoegao\/(\d+)\.html">([\s\S]+?)<\/a>[\s\S]+?<a href="\/baoxiaoegao\/\1\.html"><img\s+src="([^"]+)"/g;a.replace(e,(t,a,e,s)=>(i.push({name:e,img:s,date:"",from:"51\u7b11\u8bdd\u7f51"}),""))}catch(t){}a(i)})}},{_aO(){this._aL=1072,this._aM={},this._aN="https://www.xiaohua.com/duanzi?page=${0}"},_aP(){let t=this._aN,a=this._aM,e=o(this._aL,a);return new Promise(async a=>{let i=[];t=t.replace("${0}",e);try{let a=await r.request(t,0,!0),e=/<p class="fonts">\s+<a href="\/detail\/\d+">([\s\S]+?)<\/a>/g;a.replace(e,(t,a)=>(i.push({name:name,text:a,date:"",from:"\u7b11\u8bdd\u7f51"}),""))}catch(t){}a(i)})}}];export default h.View.extend({tmpl:(h,r,o,c)=>{let n,m,_,p,g,u,x=[],{list:d}=h;n=[];for(let t=d.length,h=0;h<t;h++){let t=d[h];p=[r(0,0,c(t.name))],_=[r("div",e,p)],p=[],t.text&&(u=[r(0,1,c(t.text))],g=[r("div",s,u)],p.push(...g)),t.img&&(g=[r("img",{loading:"lazy",class:"xl-aT",src:c(t.img)},0,0,1)],p.push(...g)),_.push(r("div",i,p)),p=[r(0,0,"\u6765\u6e90:"+c(t.from)+" "+c(t.date))],_.push(r("div",l,p)),m=[r("div",a,_)],n.push(...m)}return n.push(r("div",{_:"_","mx-intersect":o+"\x1e_aT()","mx-view":"~xl/gallery/mx-more/index"})),x.push(r("div",t,n)),r(o,0,x)},init(){let t=[];for(let a of n)a._aO(),t.push({s:a,w:0});this._aQ=t,this.set({list:[]})},assign:()=>!1,async render(){let t=this._aQ,a=Math.min(1+Math.ceil(Math.random()*t.length/1.5),t.length),e=t.sort(c).slice(0,a),i=[];for(let t of e)t.w+=1,i.push(t.s._aP());let s=h.mark(this,"_aR"),l=await Promise.all(i);if(s()){let t=this.get("list");if(l.length>1){let a=0,e={};do{let i=Math.floor(Math.random()*l.length),s=l[i];s.length?t.push(s.pop()):1!==e[i]&&(e[i]=1,a++)}while(a!=l.length)}else t.push(...l[0]);this.digest({list:t})}delete this._aS},"_aT<intersect>"(){this._aS||(this._aS=1,this.render())}});