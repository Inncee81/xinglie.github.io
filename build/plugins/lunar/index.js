let e={class:"xl-aD"},t={class:"xl-aE"},a={class:"xl-aF"};import l from"../../lib/magix.js";import r from"../../gallery/mx-dragdrop/index.js";import o from"../../lib/cron.js";l.applyStyle("xlj",".xl-aC{background:rgba(0,0,0,.13);border-radius:5px;overflow:hidden;opacity:.1;transition:all .25s}.xl-aC:hover{opacity:.8}.xl-aD{border-collapse:collapse;width:100%;text-align:center;border-spacing:0}.xl-aE{background:rgba(0,0,0,.33)}.xl-aF{font-size:18px}.xl-aG{cursor:pointer;padding:0;border-radius:4px;width:50px;height:30px}.xl-aH,.xl-aH:hover{background:rgba(0,0,0,.27)}");let s="\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("");export default l.View.extend({mixins:[r],tmpl:(l,r,o,s)=>{let h,n,p,i,d,x,g,u,y,m,c=[],{weekText:b,weeks:f,year:w,month:D,day:k}=l;p=[],i=[];for(let e=0,a=b,l=a.length;e<l;e++){x=[r(0,0,s(a[e]))],d=[r("td",t,x)],i.push(...d)}p.push(r("tr",0,i));for(let e=0,t=f,l=t.length;e<l;e++){d=[];for(let l=0,o=t[e],h=o.length;l<h;l++){let e=o[l];u=[],e.otherMonth||(m=[r(0,0,s(e.day))],y=[r("div",a,m)],u.push(...y)),g="xl-aG",e.year==w&&e.month==D&&e.day==k&&(g+=" xl-aH"),x=[r("td",{title:!e.otherMonth&&s(`${e.year}-${e.month}-${e.day}`),class:g},u)],d.push(...x)}i=[r("tr",0,d)],p.push(...i)}return n=[r("tbody",0,p)],h=[r("table",e,n)],c.push(r("div",{class:"xl-aC","mx-mousedown":o+"\x1e_aD()"},h)),r(o,0,c)},init(){let e=new Date;this.set({weekText:s,weekStart:0,year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()});let t=this.render.bind(this);o._p(t,6e5),this.ondestroy=(()=>{o._q(t)})},render(){let e,{year:t,month:a,weekStart:l}=this.get(),r=(7-l+new Date(t,a-1,1).getDay())%7,o=[],s=[],h=((e,t)=>32-new Date(e,t-1,32).getDate())(t,a);for(e=1;e<=r;e++)s.push({otherMonth:!0});for(e=1;e<=h;e++)s.push({year:t,day:e,month:a}),(e+r)%7==0&&(o.push(s),s=[]);let n=s.length;if(n){let t=7;for(e=n;e<t&&(s.push({otherMonth:!0}),(e+1)%7!=0||(o.push(s),s=[],6!=o.length));e++);}this.digest({weeks:o})},"_aD<mousedown>"(e){let t=this.root,a=parseInt(getComputedStyle(t).left),l=parseInt(getComputedStyle(t).top);this._d(e,r=>{let o=r.pageX-e.pageX,s=r.pageY-e.pageY,h=a+o,n=l+s;t.style.left=h+"px",t.style.top=n+"px"})}});