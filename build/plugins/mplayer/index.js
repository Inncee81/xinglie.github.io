import"./time.js";import"./lyric.js";import"./channels.js";let $quick_r_1_static_node,$quick_r_3_static_node,$quick_r_4_static_node,$quick_r_8_static_node,$quick_r_13_static_node,$quick_r_14_static_node,$quick_r_0_static_attr={class:"xl-aE"},$quick_r_2_static_attr={d:"M660.823 334.436H641.59c-9.072 0-16.402 7.33-16.402 16.403v132.6c-1.887-1.523-3.92-3.047-6.242-4.426L393.37 339.299c-25.548-15.822-46.45-4.21-46.45 25.91v293.582c0 30.047 20.684 41.297 45.942 25.04l226.663-146.392c2.033-1.306 3.92-2.758 5.662-4.21v139.424c0 9.073 7.33 16.403 16.402 16.403h19.233c9.073 0 16.403-7.331 16.403-16.403V350.839c0-9.073-7.331-16.403-16.403-16.403z",fill:"#fff"},$quick_r_11_static_attr={class:"xl-aV"},$quick_r_12_static_attr={class:"xl-aG"};import Magix from"../../lib/magix.js";import Dragdrop from"../../gallery/mx-dragdrop/index.js";import Player from"./player.js";Magix.applyStyle("xlh",".xl-at{position:relative;color:#fff;height:30px;top:-65px;-webkit-transition:top .2s;transition:top .2s}.xl-au{position:absolute;background:rgba(0,0,0,.4);-webkit-transition:all .25s;transition:all .25s;overflow:auto;padding:4px;top:52px;border-radius:4px;right:0;z-index:1}.xl-av,.xl-au{height:460px;width:650px}.xl-aw{top:0}.xl-ax{top:0;right:5px;width:20px;height:22px}.xl-ay{width:78px;float:left;height:90px;text-align:center;cursor:pointer;border:1px solid transparent;border-radius:5px}.xl-ay:hover{opacity:.6;border-color:hsla(0,0%,100%,.2)}.xl-az{border-color:#fff}.xl-az:hover{opacity:1;border-color:#fff}.xl-aA{display:-webkit-inline-box;display:inline-flex;-webkit-box-align:center;align-items:center;width:68px;height:60px}.xl-aB{width:auto;height:auto;max-width:100%;max-height:100%}.xl-aC{width:50px;height:50px;border:1px solid #fff;float:left;background-size:cover;background-repeat:no-repeat;background-color:#aaa;margin:-12px 2px 2px}.xl-aD{width:8px;height:8px;background:#333;border-radius:50%;margin:50%;-webkit-transform:translate(-4px,-4px);transform:translate(-4px,-4px);box-shadow:0 0 0 3px hsla(0,0%,100%,.73)}.xl-aE{height:30px;line-height:30px;background:#333;position:relative;z-index:2;width:600px;padding:0 5px;border-radius:4px}.xl-aF{font-size:12px;float:left;width:100px;overflow:hidden;margin:0 5px;position:relative}.xl-aG{position:absolute;left:0;top:0;background:#333;width:100px}@-webkit-keyframes xl-a{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes xl-a{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.xl-aC{border-radius:50%;-webkit-animation:xl-a 8s linear infinite;animation:xl-a 8s linear infinite;border-width:3px;cursor:pointer}.xl-aH{border:1px solid transparent;cursor:pointer;border-radius:2px;width:20px;height:20px;float:left;display:block;margin-top:4px}.xl-aH:hover{opacity:.6;border-color:#fff}.xl-aI{cursor:not-allowed;opacity:.6}.xl-aI:hover{border-color:transparent}.xl-aJ{border-color:#fff}.xl-aK{height:30px;display:-webkit-inline-box;display:inline-flex;-webkit-box-align:center;align-items:center;float:left}.xl-aL{width:240px}.xl-aM{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.xl-aN{font-size:12px}.xl-aO{width:80px;margin:0 10px}.xl-aP{font-size:12px;margin:0 10px}.xl-aQ{text-align:center;position:absolute;border-radius:4px;width:400px;height:60px;left:-405px;top:-15px;background:rgba(0,0,0,.4);overflow:hidden;z-index:1;cursor:move}.xl-aR{font-size:12px;opacity:.6;line-height:20px;color:#afafaf;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:20px;overflow:hidden}.xl-aS{font-weight:700;font-size:14px;opacity:1;color:#fff}.xl-aT{position:absolute;right:5px;top:0;width:14px;height:14px}@-webkit-keyframes xl-b{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translate(-50%);transform:translate(-50%)}}@keyframes xl-b{0%{-webkit-transform:translate(0);transform:translate(0)}to{-webkit-transform:translate(-50%);transform:translate(-50%)}}.xl-aU{-webkit-animation:xl-b 20s linear infinite;animation:xl-b 20s linear infinite;border-spacing:0;display:table}.xl-aV{white-space:nowrap;min-width:100px;display:table-cell}.xl-aW{-webkit-animation-play-state:paused;animation-play-state:paused}.xl-aX{-webkit-animation-name:none;animation-name:none;padding-left:0}");export default Magix.View.extend({tmpl:(t,a,i,e)=>{let r,l,s,o,c,n,_,p,d=[],{active:x,buffer:h,song:f,play:u,undo:g,ptip:m,reset:k,ntip:b,mode:w,error:v,cshow:y}=t;if(s=[],x){let t,l=h||!f.picture||!u;$quick_r_1_static_node?c=[$quick_r_1_static_node]:(n=[a("path",$quick_r_2_static_attr,0,1)],c=[$quick_r_1_static_node=a("svg",{_:"_",viewBox:"0 0 1024 1024"},n)]),r="xl-aH xl-aM",g||(r+=" xl-aI"),o=[a("span",{"mx-click":g&&i+"\x1e_aE()",title:e(m),class:r},c)],c=$quick_r_3_static_node?[$quick_r_3_static_node]:[$quick_r_3_static_node=a("div",{_:"a",class:"xl-aD"})],r="xl-aC",l&&(r+=" xl-aW"),k&&(r+=" xl-aX"),o.push(a("div",{"mx-click":!h&&f.picture&&i+"\x1e_aC()",style:null!=f.picture&&"background-image:url("+e(f.picture)+")",class:r},c)),$quick_r_1_static_node?c=[$quick_r_1_static_node]:(n=[a("path",$quick_r_2_static_attr,0,1)],c=[$quick_r_1_static_node=a("svg",{_:"_",viewBox:"0 0 1024 1024"},n)]),o.push(a("span",{class:"xl-aH","mx-click":i+"\x1e_ar()",title:e(b)},c)),c=[],"rdm"==w?($quick_r_4_static_node?n=[$quick_r_4_static_node]:(p=[a("path",{d:"M229.555 408.457h103.542c5.192 0 20.672 5.192 25.863 10.382l36.245 36.245c10.382 15.573 31.054 15.573 46.534 0 15.573-10.382 15.573-31.053 0-46.534l-36.245-36.245c-15.48-15.48-46.534-31.053-72.489-31.053h-103.45c-20.671 0-31.053 15.573-31.053 31.053 0 20.579 15.573 36.152 31.053 36.152z",fill:"#fff"},0,1),a("path",{d:"M617.771 408.457h56.916v41.436c0 10.382 5.191 15.573 15.573 10.382l119.023-77.588c10.382-5.191 10.382-15.573 0-20.671L690.26 284.428c-10.382-5.191-15.573 0-15.573 10.382v56.824h-56.916c-51.725 0-62.106 25.863-98.351 62.106L400.397 584.303c-20.672 20.671-82.779 41.435-113.833 41.435h-56.916c-20.671 0-31.053 15.48-31.053 31.054 0 20.671 15.48 31.053 31.053 31.053h56.916c51.725 0 124.215-25.863 160.459-62.106L566.046 454.99c25.863-25.863 20.672-46.534 51.725-46.534z",fill:"#fff"},0,1),a("path",{d:"M809.283 646.503L690.26 563.725c-10.382-5.191-15.573 0-15.573 10.382v51.725h-56.916c-5.191 0-20.671-5.19-25.863-10.382l-36.245-36.244c-10.382-15.574-31.053-15.574-46.534 0-15.48 10.382-15.48 31.053 0 46.534l36.245 36.244c15.574 15.48 46.534 31.054 72.49 31.054h56.915v41.436c0 10.382 5.192 15.48 15.574 10.382l119.023-77.588c10.196-5.191 10.196-15.573-.093-20.764z",fill:"#fff"},0,1)],n=[$quick_r_4_static_node=a("svg",{_:"b",viewBox:"0 0 1024 1024"},p)]),c.push(...n)):($quick_r_8_static_node?n=[$quick_r_8_static_node]:(p=[a("path",{fill:"#fff",d:"M841.8 513.1c0 .1 0 .1 0 0 0 106.1-86 192.1-192 192.1H393.7c-106 0-192-86-192-192s86-192 192-192h309.8v77.1l186.8-107.8-186.8-107.9v74H392.7c-141.4 0-256.1 114.6-256.1 256.1 0 141.4 114.6 256.1 256.1 256.1h256c141.3 0 255.9-114.4 256.1-255.7h-63z"},0,1),a("path",{fill:"#fff",d:"M542.7 626.5V388h-10.1c-4.1 3.6-9 7.2-14.6 11-5.6 3.7-11.6 7.3-18 10.7-6.3 3.4-12.8 6.5-19.4 9.3-6.6 2.8-12.8 5-18.6 6.6v27c5.2-1.3 10.5-3.1 16-5.4 5.5-2.3 10.7-4.7 15.6-7.3 4.9-2.6 9.4-5.2 13.3-7.9 4-2.7 7-5 9-7.1v201.6h26.8z"},0,1)],n=[$quick_r_8_static_node=a("svg",{_:"c",viewBox:"0 0 1024 1024"},p)]),c.push(...n)),_="\u6b63\u5728",_+="rdm"==w?"\u968f\u673a\u64ad\u653e":"\u5355\u66f2\u5faa\u73af",o.push(a("span",{class:"xl-aH","mx-click":i+"\x1e_aF()",title:_},c)),c=[],p=[a(0,0,e(f.title)+"<"+e(f.artist)+">\u2003\u2003\u2003\u2003")],n=[a("div",$quick_r_11_static_attr,p)],p=[a(0,0,e(f.title)+"<"+e(f.artist)+">\u2003\u2003\u2003\u2003")],n.push(a("div",$quick_r_11_static_attr,p)),r="xl-aU",l&&(r+=" xl-aW"),k&&(r+=" xl-aX"),c.push(a("div",{class:r},n)),v?t=v:u||h?h&&(t="\u6b63\u5728\u7f13\u51b2..."):t="\u70b9\u51fb\u5149\u76d8\u5f00\u59cb\u64ad\u653e",t&&(p=[a(0,0,e(t))],n=[a("span",$quick_r_12_static_attr,p)],c.push(...n)),o.push(a("div",{class:"xl-aF",title:e(f.title)+"<"+e(f.artist)+">"},c)),$quick_r_13_static_node?o.push($quick_r_13_static_node):o.push($quick_r_13_static_node=a("div",{_:"d","mx-view":"~xl/plugins/mplayer/time",class:"xl-aK"})),$quick_r_14_static_node?c=[$quick_r_14_static_node]:(n=[a("path",{fill:"#fff",d:"M343.25 512h-112.5c-61.875 0-112.5 50.625-112.5 112.5V737c0 61.875 50.625 112.5 112.5 112.5h112.5c61.875 0 112.5-50.625 112.5-112.5V624.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25h-112.5c-30.938 0-56.25-25.313-56.25-56.25V624.5c0-30.938 25.313-56.25 56.25-56.25h112.5c30.938 0 56.25 25.313 56.25 56.25V737zM737 118.25H624.5c-61.875 0-112.5 50.625-112.5 112.5v112.5c0 61.875 50.625 112.5 112.5 112.5H737c61.875 0 112.5-50.625 112.5-112.5v-112.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25H624.5c-30.938 0-56.25-25.313-56.25-56.25v-112.5c0-30.938 25.313-56.25 56.25-56.25H737c30.938 0 56.25 25.313 56.25 56.25v112.5zM737 512H624.5C562.625 512 512 562.625 512 624.5V737c0 61.875 50.625 112.5 112.5 112.5H737c61.875 0 112.5-50.625 112.5-112.5V624.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25H624.5c-30.938 0-56.25-25.313-56.25-56.25V624.5c0-30.938 25.313-56.25 56.25-56.25H737c30.938 0 56.25 25.313 56.25 56.25V737zm-450-618.75h-112.5c-61.875 0-112.5 50.625-112.5 112.5v112.5c0 61.875 50.625 112.5 112.5 112.5h112.5c61.875 0 112.5-50.625 112.5-112.5v-112.5c0-61.875-50.625-112.5-112.5-112.5zm56.25 225c0 30.938-25.313 56.25-56.25 56.25h-112.5c-30.938 0-56.25-25.313-56.25-56.25v-112.5c0-30.938 25.313-56.25 56.25-56.25h112.5c30.938 0 56.25 25.313 56.25 56.25v112.5z"},0,1)],c=[$quick_r_14_static_node=a("svg",{_:"e",viewBox:"0 0 1024 1024"},n)]),o.push(a("span",{class:"xl-aH","mx-click":i+"\x1e_aD()",title:"\u5f53\u524d\u5206\u7c7b\uff1a"+e(x.name)},c)),s.push(...o)}return r="xl-au",x&&!y&&(r+=" xl-ax"),(l=[a("div",$quick_r_0_static_attr,s),a("div",{_:"f","mx-view":"~xl/plugins/mplayer/lyric",class:"xl-aQ","mx-mousedown":i+"\x1e_aG()"})]).push(a("div",{"mx-view":"~xl/plugins/mplayer/channels","mx-change":i+"\x1e_ap()",class:r})),r="xl-at",x&&(r+=" xl-aw"),d.push(a("div",{class:r},l)),a(i,0,d)},mixins:[Dragdrop],init(){Player.on("_aq",()=>{if("rdm"==this.get("mode")){let t=this.get("active");Player._ar(t.channel_id)}else Player._as()}),Player.on("_at",t=>{let a={};Magix.has(t,"play")&&(a.play=t.play),Magix.has(t,"buffer")&&(a.buffer=t.buffer),this.digest(a)}),Player.on("_au",()=>{this.set({reset:!1}),this.render()}),Player.on("_av",t=>{this.digest({reset:!0,song:t.song})}),this.set({cshow:!1,reset:!0,mode:"rdm",song:{title:"\u8f6f\u4ef6\u4f5c\u8005",artist:"\u884c\u5217"}})},render(){this.digest({ptip:Player._aw(),ntip:Player._ax(),undo:Player._ay()})},_aB(){this.get("play")?Player._az():Player._aA()},"_ap<change>"(t){this.digest({active:t.channel}),Player._ar(t.channel.channel_id,!0)},"_aC<click>"(){this._aB()},"_aD<click>"(){this.digest({cshow:!this.get("cshow")})},"_ar<click>"(){let t=this.get("active");Player._ar(t.channel_id)},"_aE<click>"(){Player._aE()},"_aF<click>"(){"rdm"==this.get("mode")?this.digest({mode:"circle"}):this.digest({mode:"rdm"})},"_aG<mousedown>"(t){let a=t.eventTarget,i=parseInt(getComputedStyle(a).left),e=parseInt(getComputedStyle(a).top);this._d(t,r=>{let l=r.pageX-t.pageX,s=r.pageY-t.pageY,o=i+l,c=e+s;a.style.left=o+"px",a.style.top=c+"px"})},"$doc<keyup>"(t){if(Player._aH()){let a=t.keyCode;if(13==a||32==a)this._aB();else if(80==a)Player._aE();else if(78==a){let t=this.get("active");Player._ar(t.channel_id)}else 67==a&&this.digest({cshow:!this.get("cshow")})}},"$doc<visibilitychange>"(){Player._aI(document.hidden)},"$doc<click>"(t){Player._aH()&&this.get("cshow")&&(Magix.inside(t.target,this.root)||this.digest({cshow:!1}))}});